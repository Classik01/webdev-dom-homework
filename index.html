<!DOCTYPE html>
<html>
  <head>
    <title>Проект "Комменты"</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <ul class="comments" id="commentList">
      </ul>
      <div class="add-form">
        <input
          type="text"
          class="add-form-name"
          id="nameInput"
          placeholder="Введите ваше имя"
        />
        <textarea
          type="textarea"
          class="add-form-text"
          id="commentInput"
          placeholder="Введите ваш комментарий"
          rows="4"
        ></textarea>
        <div class="add-form-row">
          <button class="add-form-button" id="submitButton">Написать</button>
        </div>
      </div>
    </div>
  </body>

  <script>
    "use strict";
    document.addEventListener("DOMContentLoaded", function () {
      const nameInput = document.getElementById("nameInput");
      const commentInput = document.getElementById("commentInput");
      const submitButton = document.getElementById("submitButton");
      const commentList = document.getElementById("commentList");

      const commentsData = [
        {
          name: "Глеб Фокин",
          date: new Date(2022, 1, 12, 12, 18),
          text: "Это будет первый комментарий на этой странице",
          likes: 3,
          isLiked: false,
        },
        {
          name: "Варвара Н.",
          date: new Date(2022, 1, 13, 19, 22),
          text: "Мне нравится как оформлена эта страница! ❤",
          likes: 75,
          isLiked: true,
        },
      ];

      submitButton.addEventListener("click", function () {
        const name = nameInput.value;
        const commentText = commentInput.value;

        if (name.trim() === "" || commentText.trim() === "") {
          alert("Пожалуйста, заполните все поля.");
          return;
        }

        const newComment = {
          name: name,
          date: new Date(),
          text: commentText,
          likes: 0,
          isLiked: false,
        };

        commentsData.push(newComment);

        renderComments();

        nameInput.value = "";
        commentInput.value = "";
      });

      function renderComments() {
        commentList.innerHTML = "";

        commentsData.forEach((comment, index) => {
          const commentItem = document.createElement("li");
          commentItem.className = "comment";

          const commentHeader = document.createElement("div");
          commentHeader.className = "comment-header";
          commentHeader.innerHTML = `<div>${comment.name}</div><div>${comment.date.toLocaleString()}</div>`;

          const commentBody = document.createElement("div");
          commentBody.className = "comment-body";
          const commentTextDiv = document.createElement("div");
          commentTextDiv.className = "comment-text";
          commentTextDiv.innerText = comment.text;
          commentBody.appendChild(commentTextDiv);

          const commentFooter = document.createElement("div");
          commentFooter.className = "comment-footer";
          const likes = document.createElement("div");
          likes.className = "likes";
          const likeButton = document.createElement("button");
          likeButton.className = "like-button" + (comment.isLiked ? " -active-like" : "");
          likeButton.addEventListener("click", () => toggleLike(index));
          likes.innerHTML = `<span class="likes-counter">${comment.likes}</span>`;
          likes.appendChild(likeButton);
          commentFooter.appendChild(likes);

          commentItem.appendChild(commentHeader);
          commentItem.appendChild(commentBody);
          commentItem.appendChild(commentFooter);

          commentList.appendChild(commentItem);
        });
      }

      function toggleLike(index) {
        commentsData[index].isLiked = !commentsData[index].isLiked;
        if (commentsData[index].isLiked) {
          commentsData[index].likes++;
        } else {
          commentsData[index].likes--;
        }

        renderComments();
      }

      renderComments();
    });
  </script>
</html>
